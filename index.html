<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REX SYSTEM |REX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net"></script>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        body { background-color: #050505; color: white; font-family: 'Tajawal', sans-serif; overflow: hidden; height: 100vh; margin: 0; }
        
        /* Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙŠ Ø§Ù„Ø²Ø§ÙˆÙŠØ© */
        #admin-status { position: fixed; top: 15px; left: 15px; padding: 5px 15px; border-radius: 20px; font-size: 10px; font-weight: bold; z-index: 1000; border: 1px solid rgba(255,255,255,0.1); }
        .on { background: rgba(16, 185, 129, 0.2); color: #10b981; border-color: #10b981 !important; box-shadow: 0 0 10px #10b981; }
        .off { background: rgba(255,255,255,0.05); color: #666; }

        /* Ø´Ø¹Ø§Ø± Ø±ÙŠÙƒØ³ Ø§Ù„ÙØ®Ù… */
        .rex-logo { font-size: 100px; font-weight: 900; color: #a855f7; text-shadow: 0 0 30px #a855f7; z-index: 10; letter-spacing: 25px; font-style: italic; text-align: center; }

        /* Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† */
        #rules-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .rules-card { background: #0a0a0a; border: 2px solid #7c3aed; padding: 40px; border-radius: 30px; width: 450px; text-align: center; }
        .law { background: rgba(124, 58, 237, 0.05); border-right: 3px solid #7c3aed; padding: 10px; margin-bottom: 10px; text-align: right; font-size: 11px; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ³Ø§Ø± */
        #side-admin { position: fixed; top: 0; left: -360px; width: 340px; height: 100%; background: #080808; border-right: 2px solid #7c3aed; z-index: 2000; padding: 25px; transition: 0.5s; overflow-y: auto; }
        #side-admin.active { left: 0; }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† Ø§Ù„ÙŠÙ…ÙŠÙ† */
        .names-sidebar { position: fixed; right: 0; top: 0; width: 260px; height: 100%; background: #0a0a0a; border-left: 1px solid #111; padding: 20px; z-index: 50; }
        .name-item { background: #111; padding: 12px; margin-bottom: 10px; border-radius: 12px; border-right: 4px solid #7c3aed; font-size: 14px; font-weight: bold; text-align: center; }

        /* Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© */
        #floating-prize { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(124, 58, 237, 0.1); padding: 10px 40px; border-radius: 50px; backdrop-filter: blur(10px); z-index: 100; border: 1px solid #7c3aed; display: none; }

        /* Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        #draw-container { height: 120px; overflow: hidden; position: relative; border-top: 2px solid #7c3aed; border-bottom: 2px solid #7c3aed; width: 100%; display: none; flex-direction: column; align-items: center; }
        .names-track { transition: transform 6s cubic-bezier(0.1, 0, 0.1, 1); display: flex; flex-direction: column; align-items: center; }
        .slot-name { height: 120px; display: flex; align-items: center; justify-content: center; font-size: 50px; font-weight: 900; color: #a855f7; }

        /* Ø´Ø§Ø´Ø© Ù…ÙˆØ±Ø³ */
        #morse-screen { position: fixed; inset: 0; background: #000; z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body onload="init()">

    <div id="admin-status" class="off">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ØºÙŠØ± Ù…ØªØµÙ„ âšª</div>

    <!-- Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© -->
    <div id="floating-prize">
        <span class="text-xs text-purple-400 block text-center font-bold">Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ø³Ø­Ø¨ ğŸ</span>
        <span id="prize-text" class="text-xl font-black text-white">---</span>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <div id="rules-overlay">
        <div class="rules-card shadow-2xl">
            <h1 class="text-6xl font-black text-purple-600 mb-6 italic" style="letter-spacing: 15px;">R E X</h1>
            <div class="space-y-2 mb-8 italic text-right">
                <div class="law"><p class="text-purple-500 font-bold">1. Ø§Ù„Ø§Ø³Ù…:</p><p>Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙÙ‚Ø· (3 Ø­Ø±ÙˆÙ ÙØ£ÙƒØ«Ø±).</p></div>
                <div class="law"><p class="text-purple-500 font-bold">2. Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·:</p><p>ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨Ø› Ø§Ù„Ø­Ø°Ù ÙÙˆØ±ÙŠ Ù„Ø£ÙŠ Ù…Ø®Ø§Ù„Ù.</p></div>
                <div class="law"><p class="text-purple-500 font-bold">3. Ø§Ù„ØªÙˆØ§Ø¬Ø¯:</p><p>ÙŠØ¬Ø¨ Ø§Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø­Ø¨.</p></div>
            </div>
            <input type="text" id="fullName" placeholder="Ø§Ø³Ù…Ùƒ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ..." class="w-full p-4 bg-black border border-gray-800 rounded-2xl text-center text-white font-bold mb-4 outline-none focus:border-purple-600">
            <button onclick="userLogin()" class="w-full bg-purple-600 py-4 rounded-xl font-black text-xl hover:bg-purple-500 shadow-xl">Ø¯Ø®ÙˆÙ„ âš¡</button>
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div id="side-admin">
        <div class="flex justify-between items-center mb-8 border-b border-purple-900/30 pb-4">
            <h2 class="text-xl font-black text-purple-500 italic uppercase">Dashboard</h2>
            <button onclick="toggleAdmin()" class="text-red-500 font-black text-2xl hover:scale-110 transition">Ã—</button>
        </div>
        
        <div id="authBox">
            <input type="password" id="passInput" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ" class="w-full p-4 bg-black border border-gray-800 rounded-xl mb-4 text-center outline-none focus:border-purple-600">
            <button onclick="adminLogin()" class="w-full bg-purple-600 py-3 rounded-xl font-black">ØªØ­Ù‚Ù‚ ğŸ”</button>
        </div>

        <div id="adminContent" class="hidden space-y-6">
            <!-- Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ ÙŠØ¯ÙˆÙŠ -->
            <div class="bg-white/5 p-4 rounded-xl border border-white/5">
                <p class="text-[10px] text-purple-400 font-bold mb-2 uppercase">Ø¥Ø¶Ø§ÙØ© Ù…ØªØ³Ø§Ø¨Ù‚ ÙŠØ¯ÙˆÙŠ</p>
                <input type="text" id="manualName" placeholder="Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§..." class="w-full p-2 bg-black border border-gray-800 rounded mb-2 text-xs text-center outline-none">
                <button onclick="addManual()" class="w-full bg-green-700 py-2 rounded font-bold text-xs">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ø­Ø¨ +</button>
            </div>

            <!-- Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© -->
            <div class="bg-yellow-500/10 p-4 rounded-xl border border-yellow-600/30">
                <p class="text-[10px] text-yellow-500 font-bold mb-2 uppercase">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</p>
                <input type="text" id="prizeInput" oninput="updatePrizeDisplay()" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©..." class="w-full p-2 bg-black border border-gray-800 rounded mb-2 text-xs text-center">
                <button onclick="togglePrizeFloating()" class="w-full bg-yellow-700 py-1 rounded text-[10px]">Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡</button>
            </div>

            <!-- ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ -->
            <div class="bg-red-900/20 p-4 rounded-xl border border-red-600/30">
                <p class="text-[10px] text-red-400 font-bold mb-2 uppercase">ğŸ” ØªØºÙŠÙŠØ± Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ</p>
                <input type="password" id="newSecretPass" placeholder="Ø±Ù…Ø² Ø¬Ø¯ÙŠØ¯" class="w-full p-2 bg-black border border-gray-800 rounded mb-2 text-xs text-center outline-none">
                <button onclick="updateAdminPass()" class="w-full bg-red-800 py-2 rounded font-bold text-[10px]">Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯</button>
            </div>

            <button onclick="openMorse()" class="w-full bg-purple-900/20 p-3 rounded-xl text-xs text-purple-400 border border-purple-600 font-bold italic">Ø´ÙØ±Ø© Ù…ÙˆØ±Ø³ (Ø¹Ø±Ø¨ÙŠ/Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ) âš™ï¸</button>
            <button onclick="toggleDrawArea()" class="w-full bg-blue-600 py-3 rounded-xl font-black text-xs">ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø³Ø­Ø¨ ğŸ°</button>
            <button onclick="adminLogout()" class="w-full bg-red-900/40 py-2 rounded-xl text-red-500 text-xs font-bold">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ â¬…ï¸</button>
            <button onclick="resetAll()" class="w-full text-red-900 text-[10px] underline italic">ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
        </div>
    </div>

    <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙ…ÙŠÙ† -->
    <div class="names-sidebar">
        <h3 class="text-purple-500 font-black text-center mb-6 border-b border-purple-900 pb-2 italic text-sm">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† ğŸŸ¢</h3>
        <div id="listUI" class="overflow-y-auto h-[85vh] space-y-2"></div>
    </div>

    <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <main class="flex flex-col items-center justify-center h-screen w-full relative">
        <div id="rex-header" class="rex-logo">R E X</div>
        <div id="draw-container"><div id="namesTrack" class="names-track"></div></div>
        <div id="winner-display" class="hidden text-center mt-4">
            <h2 id="final-winner" class="text-7xl font-black text-white"></h2>
            <p id="final-prize" class="text-4xl text-yellow-500 font-black mt-4"></p>
        </div>
        <div id="drawArea" class="hidden fixed bottom-10">
            <button onclick="startDraw()" class="bg-white text-black px-20 py-6 rounded-3xl font-black text-3xl shadow-2xl hover:bg-purple-600 hover:text-white transition-all active:scale-95">Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø³Ø­Ø¨ ğŸ°</button>
        </div>
        <div class="fixed bottom-0 left-0 w-16 h-16 opacity-0 cursor-pointer" onclick="toggleAdmin()"></div>
    </main>

    <!-- Ø´Ø§Ø´Ø© Ù…ÙˆØ±Ø³ -->
    <div id="morse-screen">
        <h2 class="text-3xl font-black text-purple-500 mb-5 italic uppercase">Morse System</h2>
        <div id="morseDisplay" class="text-4xl text-green-500 mb-2 min-h-[50px] tracking-widest"></div>
        <div id="translation" class="text-2xl text-white mb-10 font-bold italic">Ø§Ù„ØªØ±Ø¬Ù…Ø©: ---</div>
        <div class="flex gap-4 mb-6">
            <button class="bg-gray-900 border-2 border-purple-600 w-20 h-20 rounded-2xl text-3xl" onclick="addMorse('.')">â—</button>
            <button class="bg-gray-900 border-2 border-purple-600 w-20 h-20 rounded-2xl text-3xl" onclick="addMorse('-')">â–¬</button>
            <button class="bg-blue-900 w-24 h-20 rounded-2xl font-bold" onclick="addMorse(' ')">Ù…Ø³Ø§ÙØ©</button>
        </div>
        <div class="flex gap-4">
            <button class="bg-red-900 px-10 py-3 rounded-xl font-bold" onclick="clearMorse()">Ù…Ø³Ø­</button>
            <button class="bg-gray-700 px-10 py-3 rounded-xl font-bold" onclick="closeMorse()">Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <script>
        let members = [];
        let currentPass = localStorage.getItem('rex_admin_pass') || "123";
        let morseInput = "";

        const morseLib = {
            ".-":"A", "-...":"B", "-.-.":"C", "-..":"D", ".":"E", "..-.":"F", "--.":"G", "....":"H", "..":"I", ".---":"J", "-.-":"K", ".-..":"L", "--":"M", "-.":"N", "---":"O", ".--.":"P", "--.-":"Q", ".-.":"R", "...":"S", "-":"T", "..-":"U", "...-":"V", ".--":"W", "-..-":"X", "-.--":"Y", "--..":"Z",
            ".--.-":"Ø£", "-...":"Ø¨", "-":"Øª", "---.":"Ø«", ".---":"Ø¬", "....":"Ø­", "---..":"Ø®", "-..":"Ø¯", "--..":"Ø°", ".-.":"Ø±", "--...":"Ø²", "...":"Ø³", "----":"Ø´", "-..-":"Øµ", "...-":"Ø¶", "-..-":"Ø·", "-.--":"Ø¸", ".-.-":"Ø¹", "--.-":"Øº", "..-.":"Ù", "--.--":"Ù‚", "-.-":"Ùƒ", ".-..":"Ù„", "--":"Ù…", "-.":"Ù†", "......":"Ù‡Ù€", ".--":"Ùˆ", "..":"ÙŠ"
        };

        function init() {
            const saved = localStorage.getItem('rex_members');
            if (saved) { members = JSON.parse(saved); updateUI(); }
        }

        function updateAdminPass() {
            let n = document.getElementById('newSecretPass').value.trim();
            if(n) { currentPass = n; localStorage.setItem('rex_admin_pass', n); alert("ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø¨Ù†Ø¬Ø§Ø­ âœ…"); document.getElementById('newSecretPass').value=""; }
        }

        function adminLogin() {
            if (document.getElementById('passInput').value === currentPass) {
                document.getElementById('authBox').classList.add('hidden');
                document.getElementById('adminContent').classList.remove('hidden');
                document.getElementById('admin-status').className = "on";
                document.getElementById('admin-status').innerText = "Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…ØªØµÙ„ ğŸŸ¢";
            } else { alert("Ø§Ù„Ø±Ù…Ø² Ø®Ø·Ø£!"); }
        }

        function adminLogout() {
            document.getElementById('authBox').classList.remove('hidden');
            document.getElementById('adminContent').classList.add('hidden');
            document.getElementById('admin-status').className = "off";
            document.getElementById('admin-status').innerText = "Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ØºÙŠØ± Ù…ØªØµÙ„ âšª";
            toggleAdmin();
        }

        function userLogin() {
            let n = document.getElementById('fullName').value.trim();
            if(n.length < 3) return alert("Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ±!");
            members.push({name: n});
            saveAndRefresh();
            document.getElementById('rules-overlay').style.display = 'none';
        }

        function addManual() {
            let n = document.getElementById('manualName').value.trim();
            if(n) { members.push({name: n}); saveAndRefresh(); document.getElementById('manualName').value=""; }
        }

        function startDraw() {
            if(members.length < 1) return alert("Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ©!");
            const track = document.getElementById('namesTrack');
            const container = document.getElementById('draw-container');
            const header = document.getElementById('rex-header');
            const winnerDisp = document.getElementById('winner-display');

            header.style.display = 'none';
            winnerDisp.classList.add('hidden');
            container.style.display = 'flex';
            track.innerHTML = "";
            track.style.transition = "none";
            track.style.transform = "translateY(0)";

            let longList = [];
            for(let i=0; i<40; i++) longList = longList.concat(members);
            longList.forEach(m => { track.innerHTML += `<div class="slot-name">${m.name}</div>`; });

            let winnerIndex = Math.floor(Math.random() * members.length);
            let finalStop = (longList.length - members.length) + winnerIndex;

            setTimeout(() => {
                track.style.transition = "transform 6s cubic-bezier(0.1, 0, 0.1, 1)";
                track.style.transform = `translateY(-${finalStop * 120}px)`;
            }, 100);

            setTimeout(() => {
                container.style.display = 'none';
                winnerDisp.classList.remove('hidden');
                document.getElementById('final-winner').innerText = longList[finalStop].name;
                document.getElementById('final-prize').innerText = "ğŸ " + (document.getElementById('prizeInput').value || "Ø¬Ø§Ø¦Ø²Ø© ÙƒØ¨Ø±Ù‰");
                confetti({ particleCount: 300, spread: 100, origin: { y: 0.6 } });
            }, 6500);
        }

        function addMorse(c) {
            morseInput += c;
            document.getElementById('morseDisplay').innerText = morseInput;
            let words = morseInput.trim().split('  '); 
            let translated = words.map(w => w.split(' ').map(char => morseLib[char] || '?').join('')).join(' ');
            document.getElementById('translation').innerText = "Ø§Ù„ØªØ±Ø¬Ù…Ø©: " + translated;
        }

        function clearMorse() { morseInput = ""; document.getElementById('morseDisplay').innerText = ""; document.getElementById('translation').innerText = "Ø§Ù„ØªØ±Ø¬Ù…Ø©: ---"; }
        function updatePrizeDisplay() { document.getElementById('prize-text').innerText = document.getElementById('prizeInput').value || "---"; }
        function togglePrizeFloating() { let p = document.getElementById('floating-prize'); p.style.display = (p.style.display==='none'?'block':'none'); }
        function toggleAdmin() { document.getElementById('side-admin').classList.toggle('active'); }
        function toggleDrawArea() { document.getElementById('drawArea').classList.toggle('hidden'); }
        function openMorse() { document.getElementById('morse-screen').style.display = 'flex'; }
        function closeMorse() { document.getElementById('morse-screen').style.display = 'none'; }
        function saveAndRefresh() { localStorage.setItem('rex_members', JSON.stringify(members)); updateUI(); }
        function updateUI() { let ui = document.getElementById('listUI'); ui.innerHTML = ""; members.forEach(m => { ui.innerHTML += `<div class="name-item">${m.name}</div>`; }); }
        function resetAll() { if(confirm("Ø­Ø°Ù Ø§Ù„ÙƒÙ„ØŸ")){ localStorage.clear(); location.reload(); } }
    </script>
</body>
</html>

